<!DOCTYPE html>
<!--
 Embedded scratch crap
 +-->
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Super Mario</title>
	<style>
		body {
			font-family: "Helvetica Neue", "Lato", Verdana, Helvetica, Geneva, sans-serif;
		}
	</style>
</head>
<body>
 <div id="scratch-games">
	 <h3 class="ta-mere">Embedded in my own page</h3>
	 <iframe id="super-mario"
					 allowtransparency="true"
					 width="485"
					 height="402" src="//scratch.mit.edu/projects/embed/308791139"
					 autostart="false"
					 frameborder="0"
					 allowfullscreen></iframe>
 </div>
 <button onclick="startGame();">Start</button>
 <button onclick="bam();">Simulate</button>
</body>
<script type="text/javascript">
	// keyCode: 38: arrowUp
	//          40: arrowDown
	//          37: arrowLeft
	//          39: arrowRight
	let element = document.getElementById("super-mario");

	function bam() {
		let event = new KeyboardEvent("keypress", {"code": 37});
		element.focus();
		element.dispatchEvent(event);
	}

	function startGame() {
		let dummyForTest = document.querySelector('.ta-mere');
		console.log('Dummy:', dummyForTest);

		// let greenFlag = document.querySelector('.green-flag_green-flag_1kiAo');
		let greenFlag = document.getElementById('super-mario').contentWindow.document.querySelector('.green-flag_green-flag_1kiAo');
		console.log('Found', greenFlag);
		greeFlag.focus();
		greenFlag.dispatchEvent(new MouseEvent('click'));
	}

	function activeElement() {
		console.log('Active Element', document.activeElement);
	}

	(() => {
		console.log('Starting...');
		setInterval(activeElement, 1000);
	})();
</script>
</html>
